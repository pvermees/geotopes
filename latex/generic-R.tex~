\begin{refsection}

\chapter{U--Pb}
\label{ch:UPb-R}

\noindent\begin{minipage}[t]{.5\linewidth}
\strut\vspace*{-\baselineskip}\newline
\includegraphics[width=\linewidth]{../figures/UPbFormats.png}\\
\end{minipage}
\begin{minipage}[t]{.5\textwidth}
  \texttt{IsoplotR} accommodates eight U--Pb formats. See
  Section~\ref{sec:UPbFormats} for details.
\end{minipage}

\noindent Examples using the CLI:

\begin{script}
# U-Pb format 1, 1se absolute input errors:
UPb1 <- read.data('UPb1.csv',method='U-Pb',format=1)
# U-Pb format 6, 1se relative input errors:
UPb2 <- read.data('UPb6.csv',method='U-Pb',format=6,ierr=3)
# U-Pb format 8, 2se relative input errors:
UPb3 <- read.data('UPb8.csv',method='U-Pb',format=8,ierr=4)
\end{script}

\noindent where \texttt{UPb1.csv}, \texttt{UPb6.csv} and
\texttt{UPb8.csv} are files that are included in \texttt{IsoplotR} and
whose file path can be found as follows:

\begin{console}
fn <- system.file('UPb1.csv',package='IsoplotR')
\end{console}

\noindent\begin{minipage}[t]{.15\linewidth}
\strut\vspace*{-\baselineskip}\newline
\includegraphics[width=\linewidth]{../figures/UPbPlotdevices.png}
\end{minipage}
\begin{minipage}[t]{.85\textwidth}
  U--Pb data can be visualised on five or six different plot devices
  and output tables. The \texttt{isochron} option is only available
  for formats 4--8 and is invisible otherwise. See the remaining
  sections of this chapter for examples of these output options.
\end{minipage}

\section{General options}
\label{sec:general}

\begin{enumerate}

  \item\label{it:UPbLambdairatio} Isotopic ratios and decay constants:

\noindent\begin{minipage}[t]{.55\linewidth}
\strut\vspace*{-\baselineskip}\newline
\includegraphics[width=\linewidth]{../figures/UPbLambda.png}
\end{minipage}
\begin{minipage}[t]{.45\linewidth}
  The default \textsuperscript{238}U/\textsuperscript{235}U ratio is
  given by \citet{hiess2012}, and the U and Th decay constants by
  \citet{jaffey1971} and \citet{leroux1963}, respectively. These
  values and their uncertainties can be changed here.
\end{minipage}

\begin{script}
# use the Steiger and Jaeger (1977) value with zero uncertainty
settings('iratio','U238U235',137.88,0)
# use the Schoene et al. (2006) value and uncertainty
settings('lambda','U238',0.000154993,0.00000013) 
\end{script}

\item\label{it:common-Pb-concordia} Common Pb correction of the
  individual aliquots can be carried out using the methods of
  Section~\ref{sec:common-Pb}. This may be useful for single grain
  analysis tools such as the KDE, CAD, radial or weighted mean
  plot. For cogenetic aliquots that form an isochron, the common Pb is
  best left uncorrected. In this case the most reliable age estimate
  is given by the isochron through the uncorrected data, which can be
  visualised on a concordia diagram (Section~\ref{sec:concordia-R}) or
  (for formats 4--8) as a separate isochron plot
  (Section~\ref{sec:UPb-isochron-R}).

\noindent\begin{minipage}[t]{.4\linewidth}
\strut\vspace*{-\baselineskip}\newline
\includegraphics[width=\linewidth]{../figures/CommonPb.png}
\end{minipage}
\begin{minipage}[t]{.6\linewidth}
  A common Pb menu is available for all output types except
  \texttt{isochron}. It gives access to four different common Pb
  treatments that can be applied to the data before plotting.
\end{minipage}

\begin{enumerate}
\item\begin{minipage}[t]{.4\linewidth}
  \strut\vspace*{-\baselineskip}\newline
  \includegraphics[width=\linewidth]{../figures/nominalcommonpb.png}
  \end{minipage}
  \begin{minipage}[t]{.6\linewidth}
    Selecting the \texttt{nominal} option implements the common Pb
    correction algorithm of
    Section~\ref{sec:common-Pb}.\ref{it:nominalcommonpb}.
  \end{minipage}

  \noindent\begin{minipage}[t]{.4\linewidth}
  \strut\vspace*{-\baselineskip}\newline
  \includegraphics[width=\linewidth]{../figures/initialPb76.png}
  \end{minipage}
  \begin{minipage}[t]{.6\linewidth}
    If \texttt{nominal} has been selected, and the data are of formats
    1--3, a new text box appears with the
    \textsuperscript{207}Pb/\textsuperscript{206}Pb ratio of the
    common Pb.
  \end{minipage}

\begin{script}
settings('iratio','Pb207Pb206',1.106)
radialplot(UPb1,common.Pb=1)
\end{script}

  \noindent\begin{minipage}[t]{.4\linewidth}
  \strut\vspace*{-\baselineskip}\newline
  \includegraphics[width=\linewidth]{../figures/initialPb764.png}
  \end{minipage}
  \begin{minipage}[t]{.6\linewidth}
    For U--Pb data formats 4--6, the nominal common Pb composition is specified
    as a pair of \textsuperscript{206}Pb/\textsuperscript{204}Pb and 
    \textsuperscript{207}Pb/\textsuperscript{204}Pb ratios.
  \end{minipage}

\begin{script}
settings('iratio','Pb206Pb204',9.307)
settings('iratio','Pb207Pb204',10.294)
weightedmean(UPb2,common.Pb=1)
\end{script}

  \noindent\begin{minipage}[t]{.4\linewidth}
  \strut\vspace*{-\baselineskip}\newline
  \includegraphics[width=\linewidth]{../figures/initialPb876.png}
  \end{minipage}
  \begin{minipage}[t]{.6\linewidth}
    Finally, for U--Pb data formats 7 and 8, the nominal common Pb
    composition is specified as a pair of
    \textsuperscript{208}Pb/\textsuperscript{206}Pb and
    \textsuperscript{208}Pb/\textsuperscript{207}Pb ratios.
  \end{minipage}

\begin{script}
settings('iratio','Pb208Pb206',3.1671)
settings('iratio','Pb208Pb207',2.8634)
weightedmean(UPb3,common.Pb=1)
\end{script}

\item\noindent\begin{minipage}[t]{.4\linewidth}
  \strut\vspace*{-\baselineskip}\newline
  \includegraphics[width=\linewidth]{../figures/isochroncommonpb.png}
  \end{minipage}
  \begin{minipage}[t]{.6\linewidth}
    Selecting the \texttt{isochron} option implements the common Pb
    correction algorithm of
    Section~\ref{sec:common-Pb}.\ref{it:isochroncommonpb}. In other
    words, it projects all the aliquots parallel to the isochron and
    onto the radiogenic dimension. It is important to reiterate that
    selecting this option does \textbf{not} return the isochron age!
  \end{minipage}
  
\begin{script}
kde(UPb2,common.Pb=2)
\end{script}
  
\item\noindent\begin{minipage}[t]{.4\linewidth}
  \strut\vspace*{-\baselineskip}\newline
  \includegraphics[width=\linewidth]{../figures/staceykramerscommonpb.png}
  \end{minipage}
  \begin{minipage}[t]{.6\linewidth}
    Selecting the \texttt{Stacey-Kramers} option implements the common
    Pb correction algorithm of
    Section~\ref{sec:common-Pb}.\ref{it:separate-stacey-kramers}.
  \end{minipage}

\begin{script}
cad(UPb1,common.Pb=3)
\end{script}

\end{enumerate}

\item Initial disequilibrium can be activated by ticking the
  corresponding box in the GUI, or by calling the \texttt{diseq()}
  function from the CLI. The output of the latter function must be
  called from the \texttt{read.data()} function.

\noindent\begin{minipage}[t]{.6\linewidth}
  \strut\vspace*{-\baselineskip}\newline
  \includegraphics[width=\linewidth]{../figures/UPbDisequilibriumSettings.png}
  \end{minipage}
  \begin{minipage}[t]{.4\linewidth}
    Ticking the initial disequilibrium box reveals the decay constants
    of \textsuperscript{234}U, \textsuperscript{230}Th,
    \textsuperscript{226}Ra and \textsuperscript{231}Pa.  From the
    CLI, these parameters can be changed using the \texttt{settings()}
    function in exactly the same way as shown in
    Section~\ref{sec:general}.\ref{it:UPbLambdairatio}.
  \end{minipage}

\begin{enumerate}

\item There are two ways to specify the initial disequilibrium
  conditions for \textsuperscript{234}U and \textsuperscript{230}Th:
  
\noindent\begin{minipage}[t]{.6\linewidth}
  \strut\vspace*{-\baselineskip}\newline
  \includegraphics[width=\linewidth]{../figures/U234-disequilibrium.png}
  \end{minipage}
  \begin{minipage}[t]{.4\linewidth}
If the sample is young enough that secular equilibrium has not yet
been re-established, then any measured remanent disequilibrium can be
specified here.
  \end{minipage}

\noindent CLI example:
\begin{script}
d <- diseq(U48=list(x=1.05,option=2))
UPb <- read.data('diseq.csv',method='U-Pb',format=2,d=d)
concordia(UPb,type=2)
\end{script}

\item For the shortest lived isotopes \textsuperscript{226}Ra and
  \textsuperscript{231}Pa, only one option is available:
  
\noindent\begin{minipage}[t]{.6\linewidth}
  \strut\vspace*{-\baselineskip}\newline
  \includegraphics[width=\linewidth]{../figures/Ra226-disequilibrium.png}
\end{minipage}
\begin{minipage}[t]{.4\linewidth}
It is generally not possible to measure the remanent disequilibrium
for these isotopes, so the only option is to specify the hypothesised
initial activity ratio.
\end{minipage}

\noindent CLI example:
\begin{script}
d <- diseq(RaU=list(x=1.2,option=1))
UPb <- read.data('diseq.csv',method='U-Pb',format=2,d=d)
concordia(UPb,type=2)
\end{script}

\item Finally, for U--Pb data of formats 7 and 8 (which include the
  \texttt{232}Th/\textsuperscript{238}U ratio of the mineral), there
  is a fourth way to specify the initial
  \textsuperscript{230}Th/\textsuperscript{238}U activity ratio, by
  supplying the measured Th/U-ratio of the magma, determined by
  geochemical analysis of the whole rock or volcanic glass:

\noindent\begin{minipage}[t]{.6\linewidth}
    \strut\vspace*{-\baselineskip}\newline
    \includegraphics[width=\linewidth]{../figures/Th230-disequilibrium.png}
  \end{minipage}
  \begin{minipage}[t]{.4\linewidth}
    \texttt{IsoplotR} combines this measured ratio with the
    \textsuperscript{232}Th/\textsuperscript{238}U-ratio of the
    minerals to compute the Th/U fractionation factor.
  \end{minipage}

\noindent CLI example:
\begin{script}
d <- diseq(ThU=list(x=3,option=3))
UPb <- read.data('diseq.csv',method='U-Pb',format=8,d=d)
radialplot(UPb)
\end{script}

\end{enumerate}

The different disequilibrium settings can be combined in the GUI, and
from the command line using the \texttt{diseq} function:

\begin{script}
d <- diseq(U48=list(x=1.05,option=1),ThU=list(x=3,option=3),
           RaU=list(x=1.2,option=2),PaU=list(x=3,option=1))
UPb <- read.data('diseq.csv',method='U-Pb',format=2,d=d)
concordia(UPb,type=2)
\end{script}

\end{enumerate}

\section{concordia} \label{sec:concordia-R}

\noindent\begin{minipage}[t]{.3\linewidth}
  \strut\vspace*{-\baselineskip}\newline
  \includegraphics[width=\linewidth]{../figures/ConcordiaMenu.png}
\end{minipage}
\begin{minipage}[t]{.7\linewidth}
  \texttt{IsoplotR} offers three types of concordia diagrams. The
  U--Th--Pb diagram is only available for U--Pb data formats 7 and 8.
\end{minipage}

\begin{script}
concordia(UPb1,type=1) # Wetherill
concordia(UPb1,type=2) # Tera-Wasserburg
concordia(UPb3,type=3) # U-Th-Pb
\end{script}

\begin{enumerate}

\item The limits of the concordia diagram can be specified in two
  ways:

  \noindent\begin{minipage}[t]{.4\linewidth}
  \strut\vspace*{-\baselineskip}\newline
  \includegraphics[width=\linewidth]{../figures/Concordiatlim.png}
\end{minipage}
\begin{minipage}[t]{.6\linewidth}
  The first option is to specify the minimum and maximum age of the
  concordia line.
\end{minipage}

\begin{script}
# Wetherill diagram from 300 to 3000 Ma:
concordia(UPb1,tlim=c(300,3000)) 
\end{script}

\noindent\begin{minipage}[t]{.4\linewidth}
  \strut\vspace*{-\baselineskip}\newline
  \includegraphics[width=\linewidth]{../figures/ConcordiaXYlim.png}
\end{minipage}
\begin{minipage}[t]{.6\linewidth}
  Alternatively, the limits of the concordia diagram can also be
  specified by the minimum and maximum extent of the horizontal and
  vertical axis.
\end{minipage}

\begin{script}
# Tera-Wasserburg diagram with U238/Pb206 limits from 10 to 30
# and Pb207/Pb206 limits from 0.05 to 0.06:
concordia(UPb1,type=2,xlim=c(10,30),ylim=c(0.05,0.06))
\end{script}

\item By default, \texttt{IsoplotR} plots error ellipses and
  calculates confidence intervals at a 95\% confidence level.

  \noindent\begin{minipage}[t]{.4\linewidth}
  \strut\vspace*{-\baselineskip}\newline
  \includegraphics[width=\linewidth]{../figures/ConcordiaAlpha.png}
\end{minipage}
\begin{minipage}[t]{.6\linewidth}
To plot the data as `2 sigma' ellipses, this can be changed to
$\alpha=0.14$ here, which covers 86\% of the area under a bivariate
normal distribution:
\end{minipage}

\begin{console}
concordia(UPb1,alpha=0.14)
\end{console}

\item When an extra variable is entered in the optional \texttt{(C)}
  column of the input table, this can be used as a colour scale (see
  Section~\ref{sec:GUI}).

  \noindent\begin{minipage}[t]{.4\linewidth}
  \strut\vspace*{-\baselineskip}\newline
  \includegraphics[width=\linewidth]{../figures/ConcordiaColours.png}
\end{minipage}
\begin{minipage}[t]{.6\linewidth}
  The corresponding fill and stroke colours can be specified by
  entering \texttt{R} code in the text box of the GUI.\\
\end{minipage}

\noindent To illustrate the different possibilities, let us consider a
U--Pb dataset of format~7 or 8 and use the Th/U ratios to build a
colour scale:
\begin{console}
ThU <- UPb3$x$Th232U238
\end{console}

\noindent Specify the fill colours by name:
\begin{console}
concordia(UPb3,levels=ThU,ellipse.fill=c('blue','red'))
\end{console}

\noindent Using red-green-blue-transparency (rgb-alpha) specifiers:
\begin{console}
concordia(UPb3,levels=ThU,ellipse.fill=c(rbg(1,0,0,0.5),rgb(0,1,0,0.5)))
\end{console}

\noindent Specifying the stroke colours as a colour palette with 80\% opacity
and using a uniform white colour for the fill colour:
\begin{script}
concordia(UPb3,levels=ThU,ellipse.fill='white',
          ellipse.stroke=heat.colors(n=10,alpha=0.8))
\end{script}

\noindent Leaving the error ellipses empty but using a reversed colour palette
for the stroke colour:
\begin{console}
concordia(UPb3,levels=ThU,ellipse.fill=NA,ellipse.stroke=rev(rainbow(n=10)))
\end{console}

\noindent\begin{minipage}[t]{.4\linewidth}
\strut\vspace*{-\baselineskip}\newline
\includegraphics[width=\linewidth]{../figures/UPbColourLabel.png}
\end{minipage}
\begin{minipage}[t]{.6\linewidth}
  Specifying colour levels adds a colour bar to the concordia diagram,
  which can be labelled for clarity.
\end{minipage}

\begin{console}
concordia(UPb3,levels=ThU,clabel='Th/U')
\end{console}

\item \texttt{IsoplotR} automatically chooses a `pretty' sequence of
  age ticks for the concordia line.

  \noindent\begin{minipage}[t]{.4\linewidth}
  \strut\vspace*{-\baselineskip}\newline
  \includegraphics[width=\linewidth]{../figures/Concordiatticks.png}
\end{minipage}
\begin{minipage}[t]{.6\linewidth}
  These default values can be overruled by a comma separated list of
  numerical values (in Myr).
\end{minipage}

\begin{console}
concordia(UPb1,ticks=c(230,240,250))
\end{console}

Alternatively, the \texttt{ticks} argument can also be used to simply
specify the number of ticks:

\begin{console}
concordia(UPb1,ticks=10)
\end{console}

\item Labelling the error ellipses can be useful to identify outliers
  or otherwise noteworthy aliquots.

  \noindent\begin{minipage}[t]{.3\linewidth}
  \strut\vspace*{-\baselineskip}\newline
  \includegraphics[width=\linewidth]{../figures/concordiashownumbers.png}
\end{minipage}
\begin{minipage}[t]{.7\linewidth}
  Ticking the box labels the ellipses with the row numbers of the
  input data.
\end{minipage}

\begin{console}
concordia(UPb1,show.numbers=TRUE)
\end{console}

\item The font size of the sample numbers, axis labels, and any legend
  can be adjusted with a multiplier.

\noindent\begin{minipage}[t]{.3\linewidth}
\strut\vspace*{-\baselineskip}\newline
\includegraphics[width=\linewidth]{../figures/concordiacex.png}
\end{minipage}
\begin{minipage}[t]{.7\linewidth}
Values greater than 1 increase the font size, values less than 1
reduce it.  
\end{minipage}

At the CLI, the font size is controlled by the environment variable
\texttt{cex}, which can be changed with the \texttt{par()} function:

\begin{script}
oldpar <- par(cex=1.2)
concordia(UPb1,show.numbers=TRUE)
par(oldpar) # restore the old cex value
\end{script}

\item Besides a data visualisation device, the concordia diagram can
  also be used as a vehicle for various numerical calculations:

\noindent\begin{minipage}[t]{.3\linewidth}
  \strut\vspace*{-\baselineskip}\newline
  \includegraphics[width=\linewidth]{../figures/ConcordiaShowAge.png}
\end{minipage}
\begin{minipage}[t]{.7\linewidth}
  Selecting the \texttt{concordia} option adds a white ellipse with
  the concordia composition to the plot, as well as a legend with the
  concordia age, confidence intervals, MSWD and p-values.
\end{minipage}

Compute the concordia age of the first 9 aliquots. Show the
10\textsuperscript{th} aliquot but do not use it for the calculation:

\begin{console}
concordia(UPb1,show.age=1,omit=10)
\end{console}

\item Decay constant uncertainties can be visualised as a thicker
  concordia line, and propagated into any derived numerical values.

\noindent\begin{minipage}[t]{.35\linewidth}
\strut\vspace*{-\baselineskip}\newline
\includegraphics[width=\linewidth]{../figures/concordiaexterr.png}
\end{minipage}
\begin{minipage}[t]{.65\linewidth}
  Ticking the box adds the decay constant (and
  \textsuperscript{238}U/\textsuperscript{235}U ratio) uncertainty
  after the concordia composition has been calculated.
\end{minipage}

The following code snippet does not only omit the
10\textsuperscript{th} aliquot from the calculation, but also removes
it from the plot altogether. The external uncertainties are added by
the optional \texttt{exterr} argument:

\begin{console}
concordia(UPb1,show.age=1,hide=10,exterr=TRUE)
\end{console}

\item \texttt{IsoplotR} implements three discordia regression models,
  as discussed in Section~\ref{sec:discordia}.

  \noindent\begin{minipage}[t]{.3\linewidth}
  \strut\vspace*{-\baselineskip}\newline
  \includegraphics[width=\linewidth]{../figures/discordia.png}
  \end{minipage}
  \begin{minipage}[t]{.7\linewidth}
    By default the discordia regression is unconstrained so that both
    the age and common Pb composition of cogenetic aliquots can be
    simultaneously estimated.\\
  \end{minipage}

  \noindent Visualising a model-1 fit in three dimensions on a
  Tera-Wasserburg concordia diagram, which returns the isochron age
  and common Pb composition:
\begin{console}
concordia(UPb2,type=2,show.age=2)
\end{console}

\noindent Model-2 regression of the same data visualised on a
Wetherill concordia diagram, which reports the upper and lower age
intercept:
\begin{console}
concordia(UPb2,type=1,show.age=3)
\end{console}

\item The discordia line can also be anchored to a particular common
  Pb composition.
  
  \noindent\begin{minipage}[t]{.3\linewidth}
  \strut\vspace*{-\baselineskip}\newline
  \includegraphics[width=\linewidth]{../figures/anchoreddiscordia.png}
  \end{minipage}
  \begin{minipage}[t]{.7\linewidth}
For formats 1--3, the common Pb anchored is specified via a
\textsuperscript{207}Pb/\textsuperscript{206}Pb value. For formats
4--6, it is specified via a pair of
\textsuperscript{206}Pb/\textsuperscript{204}Pb and
\textsuperscript{207}Pb/\textsuperscript{204}Pb values, and for
formats~7 and 8, via the initial
\textsuperscript{206}Pb/\textsuperscript{208}Pb and
\textsuperscript{207}Pb/\textsuperscript{208}Pb values.    
  \end{minipage}

\noindent Specifying the common Pb composition is done in exactly the
same way as the common Pb corrections of
Section~\ref{sec:general}.\ref{it:common-Pb-concordia}. For example:

\begin{script}
settings('iratio','Pb206Pb204',9.307)
settings('iratio','Pb207Pb204',10.294)
concordia(UPb2,type=2,show.age=3,anchor=1)
\end{script}

\item Alternatively, the discordia line can also be anchored to a
  particular age intercept.

\noindent\begin{minipage}[t]{.4\linewidth}
\strut\vspace*{-\baselineskip}\newline
\includegraphics[width=\linewidth]{../figures/discordiaageanchor.png}
\end{minipage}
\begin{minipage}[t]{.6\linewidth}
  Selecting the \texttt{age} option adds a text box to the GUI in
  which the age anchor can be specified (in Ma).
\end{minipage}

From the CLI:
\begin{console}
concordia(UPb2,type=2,show.age=3,anchor=c(2,300))
\end{console}

\item The number of significant digits can be specified relative to
  the analytical uncertainty. For example, if \texttt{sigdig}=2, then
  $123.45678 \pm 0.12345$ is rounded to $123.46 \pm 0.12$.

\noindent\begin{minipage}[t]{.4\linewidth}
\strut\vspace*{-\baselineskip}\newline
\includegraphics[width=\linewidth]{../figures/sigdig.png}
\end{minipage}
\begin{minipage}[t]{.6\linewidth}
  The significant digits affect all numerical output that is reported
  in the figure legend.
\end{minipage}

Reporting model-3 discordia regression results to 3 significant
digits:
\begin{console}
concordia(UPb2,show.age=4,sigdig=3)
\end{console}

\end{enumerate}

\section{isochrons} \label{sec:UPb-isochron-R}

The option to visualise U--Pb data as isochrons is only available for
data formats 4--8.

\begin{enumerate}

  \item For formats 4--6, \textsuperscript{204}Pb is used as a
    normalising isotope
    (Section~\ref{sec:discordia}.\ref{it:UPbIsochron46}).

\noindent\begin{minipage}[t]{.3\linewidth}
\strut\vspace*{-\baselineskip}\newline
\includegraphics[width=\linewidth]{../figures/UPbIsochron.png}
\end{minipage}
\begin{minipage}[t]{.7\linewidth}
Either \textsuperscript{206}Pb or \textsuperscript{207}Pb can be used
as the radiogenic isotope.
\end{minipage}

\noindent Using the CLI to create a two-panel plot of
\textsuperscript{204}Pb-based isochron diagrams:
\begin{script}
par(mfrow=c(1,2))
isochron(UPb2,type=1) # 204Pb/206Pb vs. 238U/206Pb
isochron(UPb2,type=2) # 204Pb/207Pb vs. 235U/207Pb
\end{script}

\item U--Th--Pb isochrons for formats~7 and 8 can be visualised in
  four different ways. Let \textsuperscript{208}Pb\textsubscript{c},
  \textsuperscript{207}Pb\textsubscript{c} and
  \textsuperscript{206}Pb\textsubscript{c} be the
  \textsuperscript{208}Pb, \textsuperscript{207}Pb and
  \textsuperscript{206}Pb component with the radiogenic component
  removed. Then these non radiogenic components can be used as a
  normalising isotope for the U- and Th-decay systems.

\noindent\begin{minipage}[t]{.3\linewidth}
\strut\vspace*{-\baselineskip}\newline
\includegraphics[width=\linewidth]{../figures/UPbFormats78isochronMenu.png}
\end{minipage}
\begin{minipage}[t]{.7\linewidth}
  \textsuperscript{208}Pb\textsubscript{c} is used as a normalising
  isotope for the uranium clock, and
  \textsuperscript{206}Pb\textsubscript{c} or
  \textsuperscript{207}Pb\textsubscript{c} for the thorium clock.
\end{minipage}
  
\noindent Using the CLI to create a ${2}\times{2}$ grid of isochron
diagrams:
\begin{script}
par(mfrow=c(2,2))
isochron(UPb3,type=1) # 208Pbc/206Pb vs. 238U/206Pb
isochron(UPb3,type=2) # 208Pbc/207Pb vs. 235U/207Pb
isochron(UPb3,type=3) # 206Pbc/208Pb vs. 232Th/208Pb
isochron(UPb3,type=4) # 207Pbc/208Pb vs. 232Th/208Pb
\end{script}

\item \noindent\begin{minipage}[t]{.45\linewidth}
  \strut\vspace*{-\baselineskip}\newline
  \includegraphics[width=\linewidth]{../figures/UPbIsochronModels.png}
\end{minipage}
\begin{minipage}[t]{.55\linewidth}
  The same three regression models that were available for discordia
  regression under the \texttt{concordia} function are also available
  under the \texttt{isochron} function.  In fact, their numerical
  output is exactly the same.
\end{minipage}

\noindent $2\times{2}$ grid of CLI examples:
\begin{console}
par(mfrow=c(2,2))
# model-3 regression of 204Pb/206Pb vs. 238U/206Pb:
isochron(UPb2,type=1,model=3)
# model-2 regression of 204Pb/207Pb vs. 235U/207Pb:
isochron(UPb2,type=2,model=2)
# model-1 regression of 208Pbc/206Pb vs. 238U/206Pb:
isochron(UPb3,type=2,model=1)
# model-3 regression of 207Pbc/208Pb vs. 232Th/208Pb:
isochron(UPb3,type=3,model=3)
\end{console}

\item \noindent\begin{minipage}[t]{.45\linewidth}
  \strut\vspace*{-\baselineskip}\newline
  \includegraphics[width=\linewidth]{../figures/UPbIsochronExtraOptions.png}
\end{minipage}
  \begin{minipage}[t]{.55\linewidth}
    The output of the \texttt{isochron} function can be modified using
    many of the same optional arguments as the \texttt{concordia}
    function.  Thus, we can change the horizontal (\texttt{xlim}) and
    vertical (\texttt{ylim}) extent of the plot, adjust the number of
    significant digits (\texttt{sigdig}), modify the significance
    level (\texttt{alpha}) of the numerical results and error
    ellipses, label the error ellipses with the sample numbers
    (\texttt{show.numbers}), propagate the decay constant
    uncertainties \texttt{exterr}, and label the and colour those
    ellipses (\textt{ellipse.fill} and \texttt{ellipse.stroke})
    according to some additional variable \texttt{levels}.
\end{minipage}

From the CLI, we can also store the results of the isochron regression
in a variable for further processing. For example:
\begin{script}
ThU <- UPb3$x$Th232U238
fit <- isochron(UPb3,type=3,model=1,xlim=c(0,2000),ylim=c(0,0.5),
                alpha=0.1,sigdig=3,show.numbers=TRUE,levels=ThU,
                ellipse.fill=c('white','red'),ellipse.stroke='blue',
                clabel='Th/U')
\end{script}

\end{enumerate}

\printbibliography[heading=subbibliography]

\end{refsection}
