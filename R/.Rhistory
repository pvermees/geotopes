t(d$Q %*% diag(exp(-d$L*tt)) %*% d$Qinv %*% t(d$n0[,]))
(d$Q %*% diag(exp(-d$L*tt)) %*% d$Qinv %*% d$n0[1,])
(d$Q %*% diag(exp(-d$L*tt)) %*% d$Qinv %*% d$n0[20,])
sweep(d$Q %*% diag(exp(-d$L*tt)) %*% d$Qinv,MARGIN=1,d$n0,`%*%`)
sweep(d$Q %*% diag(exp(-d$L*tt)) %*% d$Qinv,MARGIN=2,d$n0,`%*%`)
sweep(d$n0,MARGIN=2,d$Q %*% diag(exp(-d$L*tt)) %*% d$Qinv,`%*%`)
d$Q %*% diag(exp(-d$L*tt)) %*% d$Qinv
d$n0
t(d$Q %*% diag(exp(-d$L*tt)) %*% d$Qinv %*% t(d$n0))
Q
t(d$Q %*% diag(exp(-d$L*tt)) %*% d$Qinv %*% t(d$n0))
(d$n0 %*% d$Q %*% diag(exp(-d$L*tt)) %*% d$Qinv)
out
Q
d$Q %*% diag(exp(-d$L*tt)) %*% d$Qinv
d$L
d$n0
Q
d$n0
d$n0
d$n0
d$n0
Q
d$n0
out
out
Q
out
nc
Q
nc
Q
out
out
out
nc
nc
nc
nc
nc
nc
Q
nc
out
out
nt
Q
traceback()
D$dPb207U235dl35
Q
D$dPb207U235dl35
Q
D
Q
D
Q
Q
exterr
Q
Q
exterr
Q
exterr
exterr
Q
exterr
Q
Q
exterr
Q
exterr
exterr
exterr
Q
exterr
exterr
Q
Q
nc
D
D$n0
Q
nc
x$d
Q
D
D$ThUi
Q
nc
j
Q
j
Q
Q
traceback()
Q
E
J
Q
dEdx*J%*%t(J)
deriv
Q
dEdx*J%*%t(J)
Q
traceback()
out
lta0b0w
jacobian
hessian
x
E
J
X
Y
Z
D
Q
out
K
d
drdl(d=d,K=K,den='U238',num='Pb206',parent='U238')
Q
out
tt
K
d
i
nl
H
dAdl
P
dntdl
d$nt[den,drop=FALSE]
d$nt
(d$nt[den,]*dntdl[num,]-
d$nt[num,]*dntdl[den,])/d$nt[den,,drop=FALSE]^2
Q
traceback()
dx0invdt
a
Q
traceback()
dx0invdt
x0inv
tt
Q
traceback()
traceback()
d
where
d
Q
?age
x$d
x$d[i]
i
x$d[i]
x$d
Q
traceback()
UPb3$d
traceback()
d
x
ns
d$ThU
Q
traceback()
traceback()
t.68
t.68
d
d$ThU
Q
traceback()
?median
?which.median
median
median.base
median.default
?apply
d$n0
apply(d$n0,2,'median')
apply(d$n0,1,'median')
Q
?md
traceback()
d$U48
d$n0
Q
d$n0
d$n0
d$n0
Q
traceback()
J
d
R
J
st
R
R.err
traceback()
traceback()
traceback()
a
b
dx0invdt
y0par
lud$par
y0par
where
Q
?where
install.packages('~/Documents/geotopes/R/)
)
')
install.packages('~/Documents/Programming/R/IsoplotR/',repos=NULL,type='source')
q()
n
traceback()
traceback()
traceback()
traceback()
traceback()
d=median(x$d)
d
traceback()
q()
n
Q
.2stage <- 10
p
Q
par
par
xyj[2]
p$lMF0-b5*p$lAF0
p$b4
xyj[2]-p$b4*xyj[1]
print(paste0('Fenner: Y=',p$a1,p$b1,'X if X<',p$lAFi))
print(paste0('Fenner: Y=',p$a2,p$b2,'X if X>',p$lAFi))
print(paste0('Bowen: Y=',p$lMF0-p$b3*p$lAF0,p$b3,'X'))
b5 <- (xyj[2]-p$lMF0)/(xyj[1]-p$lAF0)
print(paste0('decision: Y=',p$lMF0-b5*p$lAF0,b5,'X if X<',xyj[1]))
print(paste0('decision: Y=',xyj[2]-p$b4*xyj[1],p$b4,'X if X>',xyj[1]))
xyj
Q
traceback()
traceback()
init
uvca
uvth
init
Q
.twostage
.twostage$xy1
diff(.twostage$xy1)
par('usr')
?invisible
fit
traceback()
par
p
Q
traceback()
.twostage
?par
?CA
?TH
?left
?right
c(TRUE,FALSE) || c(TRUE,TRUE))
c(TRUE,FALSE) || c(TRUE,TRUE)
c(TRUE,FALSE) | c(TRUE,TRUE)
fit
fit
fit
x
y
left
.twostage$xyi
Q
.twostage
.twostage$xy1
Q
.twostage
out
.twostage$a1
.twostage
left
right
below(x,y,.twostage$a1,.twostage$b1)
(left & below(x,y,.twostage$a1,.twostage$b1)
)
isTH
x
out
out[isTH]
out[isTH] <- 'TH'
out
Q
out
isTH
out
Q
fit
p
out
Q
par
Q
init
pth
Q
p
pth
pca
p
Q
fit
fit
cafit
thfit
lAMFi(cafit)
lAMFi(cafit$par)
?lm
.ess.source('~/Dropbox/tectodisc/Victoria7.R', visibly = FALSE, output = TRUE)
Q
q()
n
source('~/Documents/geotopes/R/ArAr-errorprop.R')
summary(std36fit)$coefficients
vcov(std36fit)
sqrt(vcov(std36fit)[1,1])
source('~/Documents/geotopes/R/ArAr-errorprop.R')
source('~/Documents/geotopes/R/ArAr-errorprop.R')
source('~/Documents/geotopes/R/ArAr-errorprop.R')
txerr
tx
source('~/Documents/geotopes/R/ArAr-errorprop.R')
source('~/Documents/geotopes/R/ArAr-errorprop.R')
txerr
Jerr
sqrt(smp40rerr2)
sqrt(std40rerr2)
Jerr
J
Jerr
J*smp40r/smp39b
txerr/(1+txerr)
txerr/(1+J*smp40r/smp39b)
source('~/Documents/geotopes/R/ArAr-errorprop.R')
txerra
txerrb
sqrt(smp40rerr2)
sqrt(std40rerr2)
(exp(l40*tstd)-1) * (std39b/std40r)
sqrt((std39berr2/std39b^2))
tx
sqrt((std40rerr2/std40r^2))
std40r
sqrt(std40rerr2)
sqrt(std40berr2)
std40r
std40b
Jerr
Jerr
sqrt(std40rerr2/std40r^2)
sqrt(std39berr2/std39b^2)
txerra
source("~/Documents/geotopes/R/UPb.R")
rm(list=ls())
graphics.off()
setwd('~/Documents/geotopes/R/')
library(IsoplotR)
UPb1 <- read.data('UPb1.csv',method='U-Pb',format=1)
UPb2 <- read.data('UPb6b.csv',method='U-Pb',format=6,ierr=3)
UPb3 <- read.data('UPb8b.csv',method='U-Pb',format=8,ierr=4)
settings('iratio','U238U235',137.88,0)
settings('lambda','U238',0.000154993,0.00000013)
settings('iratio','Pb207Pb206',1.106)
cad(UPb1,common.Pb=1)
settings('iratio','Pb206Pb204',9.307)
settings('iratio','Pb207Pb204',10.294)
weightedmean(UPb2,common.Pb=1)
settings('iratio','Pb208Pb206',2.0)
settings('iratio','Pb208Pb207',2.5)
radialplot(UPb3,common.Pb=1)
kde(UPb2,common.Pb=3)
cad(UPb1,common.Pb=3)
d <- diseq(U48=list(x=1.05,option=2))
UPb4 <- read.data('diseq.csv',method='U-Pb',format=2,d=d)
concordia(UPb4,type=2)
d <- diseq(RaU=list(x=1.2,option=1))
UPb4 <- read.data('diseq.csv',method='U-Pb',format=2,d=d)
concordia(UPb4,type=2)
d <- diseq(ThU=list(x=4,option=3))
UPb4 <- read.data('UPb7.csv',method='U-Pb',format=7,d=d)
radialplot(UPb4)
d <- diseq(U48=list(x=0,option=1),ThU=list(x=2,option=1),
RaU=list(x=2,option=1),PaU=list(x=2,option=1))
UPb4 <- read.data('diseq.csv',method='U-Pb',format=2,d=d)
concordia(UPb4,type=2,xlim=c(0,5000),ylim=c(0.047,0.057))
concordia(UPb1,type=1) # Wetherill
concordia(UPb1,type=2) # Tera-Wasserburg
concordia(UPb3,type=3) # U-Th-Pb
concordia(UPb1,tlim=c(300,3000))
concordia(UPb1,type=2,xlim=c(10,30),ylim=c(0.05,0.06))
?concordia
d <- diseq(U48=list(x=0,option=1),ThU=list(x=2,option=1),
RaU=list(x=2,option=1),PaU=list(x=2,option=1))
UPb4 <- read.data('diseq.csv',method='U-Pb',format=2,d=d)
concordia(UPb4,type=2,xlim=c(0,5000),ylim=c(0.047,0.057))
concordia(UPb1,type=1) # Wetherill
concordia(UPb1,type=2) # Tera-Wasserburg
concordia(UPb3,type=3) # U-Th-Pb
concordia(UPb1,tlim=c(300,3000))
concordia(UPb1,type=2,xlim=c(10,30),ylim=c(0.05,0.06))
?concordia
concordia(UPb1,oerr=1)
ThU <- UPb3$x[,'Th232U238']
concordia(UPb3,levels=ThU,type=2,
ellipse.fill=c('blue','red'))
concordia(UPb3,levels=ThU,type=2,
ellipse.fill=c(rgb(1,0,0,0.5),rgb(0,1,0,0.5)))
concordia(UPb3,levels=ThU,type=2,ellipse.fill='white',
ellipse.stroke=heat.colors(n=10,alpha=0.8))
concordia(UPb3,levels=ThU,type=2,ellipse.fill=NA,
ellipse.stroke=rev(rainbow(n=10)))
concordia(UPb3,levels=ThU,type=2,clabel='Th/U')
concordia(UPb1,ticks=c(230,240,250))
concordia(UPb1,ticks=10)
concordia(UPb1,show.numbers=TRUE)
concordia(UPb1,show.age=1,omit=10)
concordia(UPb1,show.age=1,hide=10,exterr=TRUE)
concordia(UPb2,type=2,show.age=2)
concordia(UPb1,type=1,show.age=3)
settings('iratio','Pb206Pb204',9.307)
settings('iratio','Pb207Pb204',10.294)
concordia(UPb2,type=2,show.age=2,anchor=1)
concordia(UPb2,type=2,show.age=2,anchor=c(2,300))
concordia(UPb2,type=2,show.age=4,sigdig=3)
oldpar <- par(mfrow=c(1,2))
isochron(UPb2,type=1)
isochron(UPb2,type=2)
par(oldpar)
oldpar <- par(mfrow=c(2,2))
isochron(UPb3,type=1)
isochron(UPb3,type=2)
isochron(UPb3,type=3)
isochron(UPb3,type=4)
par(oldpar)
oldpar <- par(mfrow=c(2,2))
isochron(UPb2,type=1,model=3)
isochron(UPb2,type=2,model=2)
isochron(UPb3,type=2,model=1)
isochron(UPb3,type=3,model=3)
par(oldpar)
UPb5 <- read.data('UPb5b.csv',method='U-Pb',format=5)
oldpar <- par(mfrow=c(1,2))
isochron(UPb5,type=1,joint=TRUE)
isochron(UPb5,type=2,joint=TRUE)
par(oldpar)
oldpar <- par(mfrow=c(2,2))
isochron(UPb2,type=1,model=3)
isochron(UPb2,type=2,model=2)
isochron(UPb3,type=2,model=1)
isochron(UPb3,type=3,model=3)
par(oldpar)
UPb5 <- read.data('UPb5b.csv',method='U-Pb',format=5)
oldpar <- par(mfrow=c(1,2))
isochron(UPb5,type=1,joint=TRUE)
isochron(UPb5,type=2,joint=TRUE)
par(oldpar)
UPb5 <- read.data('UPb5b.csv',method='U-Pb',format=5)
oldpar <- par(mfrow=c(1,2))
isochron(UPb5,type=1,joint=FALSE)
isochron(UPb5,type=2,joint=FALSE)
par(oldpar)
?isochron
UPb5 <- read.data('UPb5b.csv',method='U-Pb',format=5)
oldpar <- par(mfrow=c(1,2))
isochron(UPb5,type=1,joint=FALSE)
isochron(UPb5,type=2,joint=FALSE)
par(oldpar)
?isochron
ThU <- UPb3$x[,'Th232U238']
fit <- isochron(UPb3,type=3,model=1,xlim=c(0,2000),
ylim=c(0,0.6),exterr=TRUE,
sigdig=3,show.numbers=TRUE,
levels=ThU,ellipse.fill=c('white','red'),
ellipse.stroke='blue',clabel='Th/U')
radialplot(UPb1,type=3)
radialplot(UPb1,type=4,cutoff.76=1200)
radialplot(UPb1,cutoff.disc=discfilter(option=5,cutoff=c(-0.1,1)))
dscf <- discfilter(option=2,before=FALSE,cutoff=c(-5,15))
radialplot(UPb2,common.Pb=2,cutoff.disc=dscf)
oldpar <- par(cex=0.9) # font magnification
radialplot(UPb3,show.numbers=TRUE,exterr=TRUE,from=5,z0=30,to=150,
oerr=4,cex=2,bg=c('white','red'),
clabel='Th/U',levels=UPb3$x[,'Th232U238'])
par(oldpar)
weightedmean(UPb1)
dscf <- discfilter(option=5,before=FALSE,cutoff=c(-2,7))
weightedmean(UPb2,type=2,common.Pb=2,cutoff.disc=dscf)
settings('alpha',0.02)
weightedmean(UPb3,random.effects=TRUE,detect.outliers=TRUE,
outlier.col='red',ranked=TRUE,from=-10,to=110,
oerr=3,sigdig=1,levels=UPb3$x[,'Th232U238'],
rect.col=rev(topo.colors(n=100)),clabel='Th/U')
settings('alpha',0.05)
